<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Memory Game - De Club van Sinterklaas</title>
<link rel="icon" type="image/png" href="PVS-Logo-RGB_cs_schoen.png" />
<style>
  *, *::before, *::after { box-sizing: border-box; }
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: #fdf6e3;
    margin: 0; padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 { color: #c0392b; margin-bottom: 10px; }

  button, select {
    font-size: 16px;
    padding: 10px 16px;
    margin: 10px;
    border-radius: 8px;
    border: none;
    background: #27ae60;
    color: white;
    font-weight: 600;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  button:hover, select:hover { background: #219150; }

  select {
    appearance: none;
    -webkit-appearance: none;
    -moz-appearance: none;
    background-image: url("data:image/svg+xml;utf8,<svg fill='white' height='16' viewBox='0 0 24 24' width='16' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/></svg>");
    background-repeat: no-repeat;
    background-position: right 12px center;
    background-size: 16px;
    padding-right: 36px;
  }

  #gameBoard {
    display: grid;
    gap: 16px;
    width: 95vw;
    max-width: 1400px;
    margin: 0 auto;
  }
  .card {
    aspect-ratio: 2 / 3;
    width: 100%;
    perspective: 1000px;
    cursor: pointer;
  }
  .card-inner {
    position: relative;
    width: 100%; height: 100%;
    text-align: center;
    transition: transform 0.6s;
    transform-style: preserve-3d;
  }
  .card.flipped .card-inner { transform: rotateY(180deg); cursor: default; }
  .card-front, .card-back {
    position: absolute;
    width: 100%; height: 100%;
    border-radius: 12px;
    backface-visibility: hidden;
    box-shadow: 0 3px 6px rgba(0,0,0,0.3);
    display: flex;
    justify-content: center; align-items: center;
    overflow: hidden;
  }
  .card-front {
    background: white;
    transform: rotateY(180deg);
    padding: 6px;
    font-size: 20px;
    font-weight: bold;
    color: #333;
  }
  .card-front img {
    width: 100%; height: 100%;
    object-fit: contain;
    display: block;
    user-select: none;
    pointer-events: none;
  }
  .card-back {
    background-color: #c0392b;
    background-image: url('logo.png');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
  }

  #stats { margin-top: 20px; font-size: 18px; color: #555; display: none; }

  /* Overlay */
  #overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.9);
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    font-weight: bold;
    z-index: 1000;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
    text-align: center;
    padding: 20px;
  }
  #overlay.show { opacity: 1; pointer-events: all; }
  #overlay button {
    margin-top: 20px;
    font-size: 1.5rem;
    padding: 12px 24px;
    border-radius: 12px;
    background: #27ae60;
  }

  .matched .card-inner { animation: shake 0.5s; }
  @keyframes shake {
    0% { transform: rotateY(180deg) translateX(0); }
    25% { transform: rotateY(180deg) translateX(-5px); }
    50% { transform: rotateY(180deg) translateX(5px); }
    75% { transform: rotateY(180deg) translateX(-5px); }
    100% { transform: rotateY(180deg) translateX(0); }
  }
</style>
</head>
<body>

<h1>Memory Game - De Club van Sinterklaas</h1>

<div id="gameBoard"></div>

<div id="stats">
  Beurten: <span id="turns">0</span> |
  Gepaarde paren: <span id="matches">0</span> / <span id="totalPairs">8</span><br>
  Speler 1: <span id="score1">0</span> punten |
  Speler 2: <span id="score2">0</span> punten
</div>

<button id="resetBtn" style="display:none;">Nieuw Spel</button>

<div id="overlay"></div>

<script>
const allImages = [
  'Danspiet.png','COOLE-Piet-nieuw-534x1024.png','cadeau.png','logo.png',
  'Kado-pieten-637x1024.png','Sinterklaasfilm2023-Fernando-4-683x1024.png',
  'Testpiet-e1719663796108.png','De-Club-van-Sinterklaas-Muziekpiet.png',
  'Sinterklaasfilm2023-Sinterklaas-62.png','Sinterklaasfilm2021-Super-Piet-16-1.png',
  'De-Club-van-Sinterklaas-Bakpiet-2.png','De-Club-van-Sinterklaas-Profpiet.png'
];

const imageNames = {
  "Danspiet.png": "Danspiet",
  "COOLE-Piet-nieuw-534x1024.png": "Coole Piet",
  "cadeau.png": "Cadeau",
  "logo.png": "Logo",
  "Kado-pieten-637x1024.png": "Kado Pieten",
  "Sinterklaasfilm2023-Fernando-4-683x1024.png": "Fernando",
  "Testpiet-e1719663796108.png": "Testpiet",
  "De-Club-van-Sinterklaas-Muziekpiet.png": "Muziekpiet",
  "Sinterklaasfilm2023-Sinterklaas-62.png": "Sinterklaas",
  "Sinterklaasfilm2021-Super-Piet-16-1.png": "Super Piet",
  "De-Club-van-Sinterklaas-Bakpiet-2.png": "Bakpiet",
  "De-Club-van-Sinterklaas-Profpiet.png": "Profpiet"
};

let cards = [], flippedCards = [], matchedCards = 0, turns = 0, lockBoard = false, totalPairs = 8;
let currentPlayer = 1, score1 = 0, score2 = 0, opponent = "human";

const gameBoard = document.getElementById('gameBoard');
const turnsDisplay = document.getElementById('turns');
const matchesDisplay = document.getElementById('matches');
const totalPairsDisplay = document.getElementById('totalPairs');
const score1Display = document.getElementById('score1');
const score2Display = document.getElementById('score2');
const stats = document.getElementById('stats');
const overlay = document.getElementById('overlay');
const resetBtn = document.getElementById('resetBtn');

function showOverlay(html, autoHide = false) {
  overlay.innerHTML = html;
  overlay.classList.add('show');
  if (autoHide) setTimeout(() => overlay.classList.remove('show'), 2000);
}

function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

function createBoard(level, mode, opp) {
  totalPairs = parseInt(level);
  opponent = opp;

  const selected = shuffle([...allImages]).slice(0, totalPairs);
  cards = [];

  if (mode === "images") {
    selected.forEach(img => {
      cards.push({ type: "image", value: img, pairId: img });
      cards.push({ type: "image", value: img, pairId: img });
    });
  } else {
    selected.forEach(img => {
      const name = imageNames[img] || img.split('.')[0];
      cards.push({ type: "image", value: img, pairId: img });
      cards.push({ type: "text", value: name, pairId: img });
    });
  }

  cards = shuffle(cards);
  matchedCards = 0; turns = 0; score1 = 0; score2 = 0; currentPlayer = 1; flippedCards = []; lockBoard = false;

  turnsDisplay.textContent = turns;
  matchesDisplay.textContent = matchedCards;
  totalPairsDisplay.textContent = totalPairs;
  score1Display.textContent = score1;
  score2Display.textContent = score2;

  if (totalPairs <= 4) gameBoard.style.gridTemplateColumns = 'repeat(4, 1fr)';
  else if (totalPairs <= 8) gameBoard.style.gridTemplateColumns = 'repeat(6, 1fr)';
  else gameBoard.style.gridTemplateColumns = 'repeat(8, 1fr)';

  gameBoard.innerHTML = '';
  cards.forEach(cardObj => {
    const card = document.createElement('div');
    card.classList.add('card');
    card.dataset.pairId = cardObj.pairId;
    card.innerHTML = `
      <div class="card-inner">
        <div class="card-front">
          ${cardObj.type === "image" ? `<img src="${cardObj.value}" alt="">` : cardObj.value}
        </div>
        <div class="card-back"></div>
      </div>
    `;
    card.addEventListener('click', () => onCardClick(card));
    gameBoard.appendChild(card);
  });

  stats.style.display = "block";
  resetBtn.style.display = "inline-block";
  showOverlay("<h2>Speler 1 begint!</h2>", true);
}

function onCardClick(card) {
  if (lockBoard || card.classList.contains('flipped')) return;
  card.classList.add('flipped');
  flippedCards.push(card);
  if (flippedCards.length === 2) {
    turns++;
    turnsDisplay.textContent = turns;
    checkForMatch();
  }
}

function checkForMatch() {
  const [c1, c2] = flippedCards;
  if (c1.dataset.pairId === c2.dataset.pairId) {
    matchedCards++;
    matchesDisplay.textContent = matchedCards;
    if (currentPlayer === 1) { score1++; score1Display.textContent = score1; }
    else { score2++; score2Display.textContent = score2; }
    flippedCards = [];

    if (matchedCards === totalPairs) {
      const result = score1 > score2 ? "üéâ Speler 1 wint!" : score2 > score1 ? "üéâ Speler 2 wint!" : "ü§ù Gelijkspel!";
      showOverlay(`<h2>${result}</h2><button onclick="startScreen()">Opnieuw spelen</button>`);
    }
  } else {
    lockBoard = true;
    setTimeout(() => {
      c1.classList.remove('flipped');
      c2.classList.remove('flipped');
      flippedCards = [];
      currentPlayer = currentPlayer === 1 ? 2 : 1;
      showOverlay(`<h2>Speler ${currentPlayer} is aan de beurt</h2>`, true);
      lockBoard = false;
      if (opponent === "computer" && currentPlayer === 2) setTimeout(computerTurn, 1200);
    }, 1000);
  }
}

function computerTurn() {
  const available = [...document.querySelectorAll('.card:not(.flipped)')];
  if (available.length < 2) return;
  shuffle(available)[0].click();
  setTimeout(() => shuffle(available)[0].click(), 800);
}

resetBtn.addEventListener('click', startScreen);

function startScreen() {
  showOverlay(`
    <h2>Welkom bij Memory!</h2>
    <p>Kies je instellingen:</p>
    <label>Level:</label>
    <select id="level">
      <option value="4">Makkelijk (4 paren)</option>
      <option value="8" selected>Gemiddeld (8 paren)</option>
      <option value="12">Moeilijk (12 paren)</option>
    </select><br>
    <label>Modus:</label>
    <select id="mode">
      <option value="images">Alleen plaatjes</option>
      <option value="imageText">Plaatjes + tekst</option>
    </select><br>
    <label>Tegenstander:</label>
    <select id="opp">
      <option value="human">Speler</option>
      <option value="computer">Computer</option>
    </select><br>
    <button onclick="begin()">Start spel</button>
  `);
}

function begin() {
  const level = document.getElementById("level").value;
  const mode = document.getElementById("mode").value;
  const opp = document.getElementById("opp").value;
  overlay.classList.remove("show");
  createBoard(level, mode, opp);
}

startScreen();
</script>

</body>
</html>
